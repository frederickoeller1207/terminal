<!DOCTYPE html>
<html lang="de">  
<head>  
  <meta charset="UTF-8" />  
  <title>M√§usegruppe Terminal</title>  
  <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;600&display=swap" rel="stylesheet">
  <style>  
    body {
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: #f9f9fb;
      padding: 20px;
      color: #1c1c1e;
    }

    h1 {
      margin-bottom: 30px;
      font-size: 28px;
      font-weight: 600;
      text-align: center;
    }

    .menu {
      margin-bottom: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }

    button {
      background-color: #ffffff;
      border: 1px solid #ccc;
      border-radius: 12px;
      padding: 14px 24px;
      font-size: 17px;
      font-weight: 500;
      color: #000;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      cursor: pointer;
      width: 90%;
      max-width: 320px;
      transition: all 0.2s ease, transform 0.1s ease;
      transform: scale(1);
      touch-action: manipulation;
    }

    button:hover {
      background-color: #f0f0f5;
    }

    button:active {
      background-color: #e0e0e5;
      transform: scale(0.97);
      box-shadow: 0 1px 3px rgba(0,0,0,0.1) inset;
    }

    #view {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }

    #home-btn {
      font-size: 20px;
      margin-left: 10px;
      cursor: pointer;
      user-select: none;
    }
  </style>  
</head>  
<body>  
  <h1 id="title">M√§usegruppe Terminal</h1>  
  <div class="menu">  
    <button id="btn-ausleihe">Spielzeug Ausleihe</button>  
    <button id="btn-checkout">Checkout</button>  
  </div>  
  <div id="view"></div>    
  <script type="module">  
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js";  
    import { getDatabase, ref, get, onValue, set } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-database.js";  
  
    const firebaseConfig = {  
      apiKey: "AIzaSyAQaNKUa-RKvUcwlPpWnEyKxcVjYV6cZuU",  
      authDomain: "gesamt-dae4e.firebaseapp.com",  
      databaseURL: "https://gesamt-dae4e-default-rtdb.europe-west1.firebasedatabase.app",  
      projectId: "gesamt-dae4e",  
      storageBucket: "gesamt-dae4e.appspot.com",  
      messagingSenderId: "844023612743",  
      appId: "1:844023612743:web:0821aa894541f89a7df862"  
    };  
  
    const app = initializeApp(firebaseConfig);  
    const db = getDatabase(app);  
  
    window.addEventListener("DOMContentLoaded", () => {  
      const view = document.getElementById("view");  
      const title = document.getElementById("title");  
      const menuDiv = document.querySelector(".menu");  
  
      document.getElementById("btn-ausleihe").onclick = loadAusleihe;  
      document.getElementById("btn-checkout").onclick = loadCheckout;  
  
      function resetView() {  
        title.innerHTML = "M√§usegruppe Terminal";  
        menuDiv.style.display = "flex";  
        view.innerHTML = "";  
      }  
  
      function showTitle(t) {  
        title.innerHTML = `${t} <span id="home-btn">üè†</span>`;  
        document.getElementById("home-btn").onclick = resetView;  
        menuDiv.style.display = "none";  
      }  
  
      function loadAusleihe() {  
        resetView();  
        showTitle("Spielzeug Ausleihe");  
  
        onValue(ref(db, "kinder"), (snapshot) => {  
          view.innerHTML = "";  
          snapshot.forEach(childSnap => {  
            const name = childSnap.key;  
            const btn = document.createElement("button");  
            btn.textContent = name;  
            btn.onclick = () => ausleihen(name);  
            view.appendChild(btn);  
          });  
        });  
      }  
  
      async function ausleihen(name) {  
        const ausleiheSnap = await get(ref(db, `ausleihen/${name}`));  
        if (ausleiheSnap.exists() && ausleiheSnap.val().best√§tigt === false) {  
          alert("Bitte gib das ausgeliehene Spielzeug zur√ºck, bevor du ein neues ausleihst.");  
          return;  
        }  
  
        const nummer = prompt(`${name}, gib bitte die Spielzeugnummer ein:`);  
        if (!nummer) return;  
  
        const spielzeugeSnap = await get(ref(db, "spielzeuge"));  
        const spielzeuge = spielzeugeSnap.exists() ? spielzeugeSnap.val() : {};  
  
        if (spielzeuge[nummer]) {  
          await set(ref(db, `ausleihen/${name}`), {  
            spielzeug: spielzeuge[nummer],  
            nummer: nummer,  
            zeit: new Date().toISOString(),  
            best√§tigt: false  
          });  
  
          const msg = document.createElement("div");  
          msg.textContent = `${spielzeuge[nummer]} erfolgreich ausgeliehen.`;  
          msg.style = "margin-top: 20px; font-weight: bold;";  
          view.appendChild(msg);  
          setTimeout(() => msg.remove(), 3000);  
        } else {  
          alert("Ung√ºltige Nummer.");  
        }  
      }  
  
      function loadCheckout() {  
        resetView();  
        showTitle("Checkout");  
  
        onValue(ref(db, "kinder"), (snapshot) => {  
          view.innerHTML = "";  
          snapshot.forEach(childSnap => {  
            const name = childSnap.key;  
            const link = childSnap.val().link;  
  
            const btn = document.createElement("button");  
            btn.textContent = name;  
            btn.onclick = () => {  
              if (link) {  
                window.location.href = link;  
              } else {  
                alert("Kein Link hinterlegt.");  
              }  
            };  
            view.appendChild(btn);  
          });  
        });  
      }  
  
      resetView();  
    });  
  </script>  
</body>  
</html>